# BCD : Final Team Project
> ”삶은 선택의 연속이지! 하지만 나 대신 골라 줘!”  
>
> **사용자 커스텀 투표 게시**를 주요 소재로 한 게시판 웹 사이트 개발 프로젝트

<br />   

### 사용된 기술 스택
<p dir="auto">
 <img src="https://img.shields.io/badge/Spring-6DB33F?style=flat&logo=Spring&logoColor=black"/>
 <img src="https://img.shields.io/badge/MyBatis-000000?style=flat&logo=&logoColor=white"/>
 <img src="https://img.shields.io/badge/Maven-C71A36?style=flat&logo=Apache Maven&logoColor=black"/>
 <img src="https://img.shields.io/badge/JSTL-0099E5?style=flat&logo=&logoColor=black"/>
 <img src="https://img.shields.io/badge/JDBC-000000?style=flat&logo=&logoColor=black"/>
 <img src="https://img.shields.io/badge/Oracle-F80000?style=flat&logo=Oracle&logoColor=black"/>
</p>


<br />   

### 팀원 소개 & 담당 기능 소개
- **김자연**  `팀장`
  - 게시글(+투표, 댓글) 관련 모든 기능 전담
    - 게시글 작성/열람/수정/삭제
    - 댓글 작성/열람/수정/삭제
    - 투표 게시/참여 등
     
- **이형주**
  - 회원 관련 모든 기능 전담
    - 일반 회원 가입/로그인
    - API를 이용한 소셜 회원 가입/로그인
    - 마이 페이지를 통한 회원 정보 수정
    - 회원 탈퇴
 
- **서수현**
  - 실시간 채팅 관련 모든 기능 전담
    - 채팅방 개설
    - 채팅방 목록 조회
    - 수/발신 등 채팅 기능 구현
 
<br />    

### 주요 기능
#### [프로젝트 요구사항]
```
1. 회원은 "일반 회원가입"과 "소셜 회원가입" 중 선택하여 가입할 수 있습니다.
2. "소셜 회원가입"을 이용해 가입한 회원은 소셜 정보를 이용해 회원가입이 가능합니다! 
3. "일반 회원가입"을 이용해 가입한 회원은 아이디와 비밀번호를 통해 로그인합니다.
4. 회원은 마이페이지 내에서 본인의 정보를 열람 및 수정할 수 있으며, 탈퇴할 수 있습니다.
5. 회원은 글 작성 시 투표 관련 정보를 포함할 수 있습니다. (투표 제목, 선택지 1, 선택지 2, 마감 기한 등)
6. 회원은 원하는 필터를 적용하여 글을 조회할 수 있고, 상세 페이지로 접근하여 해당 글의 내용과 투표 관련 내용을 열람할 수 있습니다.
7. 글 게시자를 포함해서 회원은 각 게시글마다 1 회 투표에 참여할 수 있습니다.
8. 단, 마감된 투표에는 참여할 수 없습니다.
9. 게시글 작성 시 최초에 설정된 마감 기한이 도래하면 투표는 자동으로 마감 상태로 변경되고, 글 게시자는 "즉시 마감" 버튼을 통해 최초에 입력했던 마감 기한과 관계 없이 그 즉시 투표를 마감할 수 있습니다.
10. 투표가 마감되면 게시글에는 더 많이 선택된 선택지를 [투표 결과]로 표시해 주고, 글 게시자는 "후기"를 작성할 수 있습니다.
11. 투표 참여자는 "취소" 버튼을 통해 참여를 철회할 수 있고, 재참여가 가능합니다.
12. 회원은 게시글마다 댓글을 작성할 수 있고, 본인이 작성한 댓글에 한해 댓글을 수정/삭제할 수 있습니다.
13. 회원은 원하는 필터를 적용하여 채팅방을 조회할 수 있고, 채팅방에 입장하여 접속한 타 회원과 실시간 채팅을 나눌 수 있습니다.
```
----
#### [게시글 관련] `김자연`   
> 게시글 작성/열람/수정/삭제
  1. 게시글 작성  
  1-1. 게시글 작성 시 모든 항목의 null 여부와 적정 규격 여부를 `JS`에서 한 번, `JAVA`에서 한 번, 총 두 번 검사합니다.  
  1-2. 로그인 정보가 없는 상태에서 작성 페이지로의 접속을 제한합니다. 이는 `JSP` 단에서 버튼을 보여 주지 않으며, `JAVA`의 Interceptor를 통해 다시 한번 제한합니다.   
  
  2. 게시글 열람  
  2-1. 메인 페이지에서 게시글 카드 클릭 시, 상세 페이지로 이동됩니다. 이때 조회수가 +1 업데이트되도록 쿼리가 실행됩니다.  
  2-2. 게시글 조회 시 현재 접속자의 투표 참여 여부를 받아와서 미참여자는 참여할 수 있도록, 기참여자는 철회할 수 있도록 합니다. `JSP` 단에서 케이스를 분기합니다. 또한, 현재 접속자가 게시글 작성자면서 진행 중인 투표일 경우 즉시 마감 처리 할 수 있도록 합니다.  
  2-3. 투표 항목에 대한 사진이 첨부된 글이라면 사진 또한 글에 포함되어 출력됩니다.   
  2-4. 투표 후기가 작성된 글이라면 후기 또한 글에 포함되어 출력됩니다. 마감되지 않은 투표라면 해당 부분이 출력되지 않도록 `JSP` 단에서 케이스를 분기합니다.  
  2-5. 글 작성자만이 게시글 수정/삭제 메뉴에 접근할 수 있도록 `JSP` 단에서 케이스를 분기합니다.   
  
  3. 게시글 수정/삭제  
  3-1. 글 작성자만이 게시글 수정/삭제 메뉴에 접근할 수 있습니다. `JSP` 단에서 분기했지만, `JAVA`에서 한 번 더 검사하여 올바르지 않은 접근의 경우에는 돌려보냅니다.  
  3-2. 글 수정의 경우, 투표 부분은 수정이 제한됩니다. 수정 시에도 모든 항목의 null 여부와 적정 규격 여부를 `JS`에서 한 번, `JAVA`에서 한 번, 총 두 번 검사합니다.  
     
> 댓글 작성/열람/수정/삭제
  1. 댓글 작성  
  1-1. 로그인한 사용자는 게시글에 댓글을 작성할 수 있습니다. 이는 `JSP`에서 분기하여 안내하고, `JAVA`에서 한 번 더 검사하여 등록할 수 있도록 합니다.  
  1-2. 댓글 작성 시 댓글 내용의 null 여부와 적정 규격 여부를 `JS`와 `JAVA`에서 각각 한 번씩, 총 두 번 검사합니다.  
     
  2. 댓글 열람  
  2-1. 게시글 상세 페이지 접속 시 해당 글에 작성된 댓글을 모두 확인할 수 있습니다. 이때 수정/삭제 버튼은 댓글 작성자에게만 보이도록 `JSP`에서 분기합니다.  
     
  3. 댓글 수정/삭제  
  3-1. 댓글 작성자만이 게시글 수정/삭제 메뉴에 접근할 수 있습니다. `JSP` 단에서 분기했지만, `JAVA`에서 한 번 더 검사하여 올바르지 않은 접근의 경우에는 돌려보냅니다.  
  3-2. 댓글 수정과 삭제는 `ajax`를 통해 비동기로 통신합니다. 때문에 화면이 리로드되지 않으며, 성공적으로 수정되거나 삭제된 경우에는 변경된 내용을 적용하여 화면에 출력될 수 있도록 `JS`를 통해 내용이 변경됩니다.   

> 투표 게시/참여, 후기 작성
  1. 투표 게시  
  1-2. 게시글 하나당 하나의 투표를 포함합니다. 투표 항목이 null이거나 지정 규격을 초과하지 않도록 `JS`와 `JAVA`에서 두 번에 걸쳐 검사합니다.  
  1-3. 투표 항목에 대한 사진을 업로드할 수 있으며, 사진은 `AWS S3`에 저장되고, 저장된 사진의 URL이 `DB`에 저장됩니다. 사진을 업로드하지 않았다면 해당 칼럼에는 null 값이 저장됩니다.  
  1-4. 저장된 투표 마감일에 `DB` 내에서 투표 상태가 변경될 수 있도록 Oracle 스케줄링이 하루에 한 번 마감일을 검사합니다.  

  2. 투표 참여  
  2-1. 투표에 참여하지 않은 접속자는 투표에 참여할 수 있습니다. 항목 선택 후 Pick! 버튼을 통해 투표합니다. 미참여자와 기참여자를 `JSP`에서 분기합니다.  
  2-2. 이때 유효한 투표에 유효한 시도인지를 확인하여 `DB`에 반영합니다. 참여가 성공적으로 이루어졌거나, 실패하였거나 반환된 결과를 확인 창으로 띄워 알려 줍니다.  
  2-3. 투표에 이미 참여한 접속자는 기존 투표 정보를 철회할 수 있습니다. 이때 `JAVA`에서는 해당 사용자가 참여한 정보를 다시 검사하고, 투표의 진행 여부 또한 확인하여 철회할 수 있는 상태인지 확인합니다. 가능하다면 `DB`에서 해당 참여 정보가 삭제됩니다.   
  2-4. 참여를 철회한 사용자는 다시 '투표에 첨여하지 않은 접속자'가 되어 또 다시 투표에 참여할 수 있게 됩니다. 페이지가 리로드되기에 별도 처리 없이 변경된 화면이 출력됩니다.  

  3. 후기 작성   
  3-1. 투표가 마감된 글에 한해서 작성자는 후기를 작성할 수 있습니다. `JSP` 단에서 케이스를 분기합니다. `JAVA`에서 한 번 더 검사하여 올바르지 않은 접근의 경우에는 돌려보냅니다.   
  3-2. 후기 내용이 null이거나 지정 규격을 초과하지 않도록 `JS`와 `JAVA`에서 두 번에 걸쳐 검사합니다.   
  3-3. 작성된 후기는 수정하거나 삭제할 수 있습니다.  

----
#### [회원 관련] `이형주`
> 회원가입
  1. 회원은 "일반 회원가입"과 "소셜 회원가입" 중 선택하여 가입할 수 있습니다.
  2. 소셜 회원가입    
  2-1. 소셜로그인회원의 경우 추가 본인확인 없이 회원가입이 가능합니다.(Naver/Kakao)  
  2-2. 소셜로그인회원의 경우 엑세스토큰 발급을 위한 소셜로그인링크 클릭 시 인증서버로 이동됩니다.  
  2-3. 사용자 필수정보이용 동의 후 엑세스토큰발행, BCD에서 이 토큰을 이용해 Naver(or Kakao)에 사용자 정보를 받아와 회원가입을 마무리합니다.  
  3. 일반 회원가입  
  3-1. 일반회원의 경우 휴대전화 본인인증 후 회원가입이 가능합니다.(coolsms)  
  3-2. 랜덤숫자 4자리 인증번호가 휴대전화로 발송됩니다.  
  3-3. 인증번호 일치 시에만 회원가입 진행이 가능합니다.  
  3-4. 닉네임과 PW/ID는 BCD정책에 따라 유효성검증이 필요하며 비동기통신으로 진행됩니다.  
 
> 로그인 / 로그아웃
  1. "소셜로그인"을 이용해 가입한 회원은 네이버or카카오 로그인 정보를 이용해 바로 로그인이 가능합니다!
  2. 사용자 소셜로그인 버튼 클릭 시 해당 사용자 이메일주소(snsId)를 이용해 DB 조회합니다.
  3. 조회 결과 일치하는 이메일이 있을 경우, 해당 사용자의  회원번호를 반환하며 로그인을 종료합니다. (로그인완료) 
  4. "문자인증"을 이용해 가입한 회원은 전화번호 입력 시 바로 ID/PW 입력창으로 이동 후 정보 일치 시 로그인이 가능합니다.
  5. 사용자의 비밀번호는 암호화 되어 관리됩니다.
  6. 세션만료로 로그아웃이 가능합니다.

> 회원정보수정 / 탈퇴
  1. 마이페이지는 로그인 한 사용자만 접근 가능하도록 session 내 회원번호 유무를 확인해 마이페이지 버튼 활성화를 조정합니다.
  2. 마이페이지에서 사용자는 닉네임(일반회원의 경우 비밀번호도 변경 가능)을 변경할 수 있습니다.
  3. 회원탈퇴 시 고객계정을 휴면계정으로 변경(복구가능)되며 30일도래 시점에 DB에서 자동삭제됩니다.(복구불가능) 


----
#### [채팅 관련] `서수현`  
> 채팅방 개설
 1. Modal창을 만들어 방을 생성하고, 수정합니다.(방장만 수정 가능)
 2. 채팅방 생성 시 사용자로 부터 받은 정보들을  Mybatis를 이용하여 DB에 저장하고, 저장한 정보들을 JSP페이지에 출력하여 보여줍니다.
 3. DB에서 자동 생성된 채팅방 번호롤 가져와서 방을 나눠서 채팅을 할 수 있도록 합니다.

<<<<<<< HEAD
> 채팅방 개설
 1. Modal창을 만들어 방을 생성하고,수정합니다.(방장만 수정 가능)
 2. 채팅방 생성 시 사용자로 부터 받은 정보들을  Mybatis를 이용하여 DB에 저장하고, 저장한 정보들을 JSP페이지에 출력하여 보여줍니다.
 3. DB에서 자동 생성된 채팅방 번호롤 가져와서 방을 나눠서 채팅을 할 수 있도록 합니다.
=======
> 채팅방 목록, 게시글 목록 조회
 1. 카테고리별로 해당하는 작은 카테고리 목록을 보여줍니다.
 2. 검색창에 검색어 입력 시 DB에서 검색, 정렬 후 출력합니다.
 3. 다른페이지에서 검색 시 페이지를 이동하여 목록을 출력합니다. (더보기 버튼으로 페이징)
 4. String으로 저장된 채팅 참여자 목록을 list로 변환하여 참여자 수를 구하고,입/퇴장한 참여자들을 더하거나 빼서 다시 String으로 저장합니다.
 5. 세션에서 로그인한 회원 idx로 내가 작성한 글을 조회하여 출력합니다.

> 수/발신 등 채팅 기능 구현
 1. Websocket을 이용하여 서버와 통신하고 클라이언트에게 받은 메시지들을 WebSocketSession에 연결된 클라이언트에 다시 전송합니다.
 2. 보낸메시지와 받은메시지를 구분하여 CreateElement로 메시지마다 새로운 div만들어 출력하여 보여줍니다.
 3. 주고 받은 메시지를 DB에 저장하고, 이전 메시지들을 다시 불러와 출력합니다.
>>>>>>> refs/heads/SSH

> 채팅방 목록 조회
 1. 카테고리별로 해당하는 작은 카테고리 목록을 보여줍니다.
 2. 검색창에 검색어 입력 시 DB에서 검색, 정렬 후 출력합니다.
 3. 다른페이지에서 검색 시 페이지를 이동하여 목록을 출력합니다. (더보기 버튼으로 페이징)
 4. String으로 저장된 채팅 참여자 목록을 list로 변환하여 참여자 수를 구하고,입/퇴장한 참여자들을 더하거나 빼서 다시 String으로 저장합니다.
 5. 세션에서 로그인한 회원 idx로 내가 작성한 글을 조회하여 출력합니다.

> 수/발신 등 채팅 기능 구현
 1. Websocket을 이용하여 서버와 통신하고 클라이언트에게 받은 메시지들을 WebSocketSession에 연결된 클라이언트에 다시 전송합니다.
 2. 보낸메시지와 받은메시지를 구분하여 CreateElement로 메시지마다 새로운 div만들어 출력하여 보여줍니다.
 3. 주고 받은 메시지를 DB에 저장하고, 이전 메시지들을 다시 불러와 출력합니다.
